function [dydt] = claus_burner(V,pars,yvec)
% CLAUS_BURNER 
%  H2S + 3/2O2   ->    SO2 +  H2O
% 2H2S +    SO2 <=> 3/2S2  + 2H2O
% H2S SO2 S2 H2O O2 N2 T

p = pars(1);

R = 8.314;

n(1) = yvec(1);
n(2) = yvec(2);
n(3) = yvec(3);
n(4) = yvec(4);
n(5) = yvec(5);
n(6) = yvec(6);
T    = yvec(7);

nTOT = n(1) + n(2) + n(3) + n(4) + n(5) + n(6);

y(1) = n(1) / nTOT;
y(2) = n(2) / nTOT;
y(3) = n(3) / nTOT;
y(4) = n(4) / nTOT;
y(5) = n(5) / nTOT;
y(6) = n(6) / nTOT;

c(1) = y(1) * p/(R*T);
c(2) = y(2) * p/(R*T);
c(3) = y(3) * p/(R*T);
c(4) = y(4) * p/(R*T);
c(5) = y(5) * p/(R*T);
c(6) = y(6) * p/(R*T);

cp(1) = 0.001436*T + 0.00002432*T^2 - 1.176e-8*T^3 + 31.94;
cp(2) = 0.000845*T - 0.0000431 /T^2                + 36.162;
cp(3) =                                            + 35.0;
cp(4) = 0.0113  *T                                 + 30.12;
cp(5) = 0.007171*T - 0.00008556/T^2                + 47.7;
cp(6) = 0.00418 *T                                 + 27.82;

drH(1) = -(2.31198e-35*(2.19016e40*T + 1.60936e36*T^2 + 1.02726e30*T^3 + 3.50637e29*T^4 - ...
           1.27164e26*T^5 + 3.68688e30))/T;
drH(2) = (4.62396e-35*(9.48365e38*T + 2.74613e35*T^2 + 2.04186e32*T^3 - 3.50637e29*T^4 + ...
          1.27164e26*T^5 - 9.32101e29))/T;

k(1) = 1*exp(1000*(1/500 - 1/T));
k(2) = 1*exp(1000*(1/500 - 1/T));

K(1) = max(exp(1.17873e-10*T^3 - 4.47534*log(T) - 4.87531e-7*T^2 - 0.00000285663*T + ...
           (60904.6*T + 0.00000512629)/T^2 + 21.1096),1e-10);
K(2) = max(exp(0.00113561*T + 1.5273*log(T) - 9.75062e-7*T^2 + 2.35747e-10*T^3 - ...
           (1.0*(5274.48*T - 0.00000259201))/T^2 - 3.1067),1e-10);

r(1) = k(1)*(c(1)    *c(5)^(3/2)  - c(2)      *c(4)    /K(1));
r(2) = k(2)*(c(1)^(2)*c(2)        - c(3)^(3/2)*c(4)^(2)/K(2));

dnH2SdV = - 1.0 * r(1) - 2.0 * r(2);
dnSO2dV = + 1.0 * r(1) - 1.0 * r(2);
dnS2dV  =              + 3/2 * r(2);
dnH2OdV = + 1.0 * r(1) + 2.0 * r(2);
dnO2dV  = - 3/2 * r(1);
dnN2dV  =   0;

dTdV = - r(1)*drH(1) - r(2)*drH(2);
dTdV = dTdV / (n(1)*cp(1) + n(2)*cp(2) + n(3)*cp(3) + n(4)*cp(4) + n(5)*cp(5) + n(6)*cp(6));

dydt = [dnH2SdV dnSO2dV dnS2dV dnH2OdV dnO2dV dnN2dV dTdV]';

end
